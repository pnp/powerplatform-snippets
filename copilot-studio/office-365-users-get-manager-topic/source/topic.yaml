kind: AdaptiveDialog
modelDescription: Gets the manager details of any user
beginDialog:
  kind: OnRecognizedIntent
  id: main
  intent: {}
  actions:
    - kind: SendActivity
      id: sendActivity_mOFgma
      activity: Let's get those details for you ðŸ˜Š

    - kind: Question
      id: question_4MfIos
      interruptionPolicy:
        allowInterruption: true

      variable: init:Topic.userChoice
      prompt: To confirm - are we trying to get the details of your manager or a colleague's manager?
      entity:
        kind: EmbeddedEntity
        definition:
          kind: ClosedListEntity
          items:
            - id: My manager
              displayName: My manager

            - id: My colleague's manager
              displayName: My colleague's manager

    - kind: ConditionGroup
      id: conditionGroup_WUd83N
      conditions:
        - id: conditionItem_IDEXaI
          condition: =Topic.userChoice = '{ REPLACE-WITH-INTERNAL-COPILOT-NAME }.topic.GetManagerDetails.main.question_4MfIos'.'My manager'
          actions:
            - kind: Question
              id: question_m3ehQc
              interruptionPolicy:
                allowInterruption: true

              variable: init:Topic.userEmail
              prompt: What's your email address?
              entity: StringPrebuiltEntity

            - kind: BeginDialog
              id: FttvwJ
              input:
                binding:
                  id: =Topic.userEmail

              dialog: { REPLACE-WITH-INTERNAL-COPILOT-NAME }.component.Office365Users-GetmanagerV2
              output:
                binding:
                  aboutMe: Topic.aboutMe
                  accountEnabled: Topic.accountEnabled
                  birthday: Topic.birthday
                  businessPhones: Topic.businessPhones
                  city: Topic.city
                  companyName: Topic.companyName
                  country: Topic.country
                  department: Topic.department
                  displayName: Topic.displayName
                  givenName: Topic.givenName
                  hireDate: Topic.hireDate
                  id: Topic.id
                  interests: Topic.interests
                  jobTitle: Topic.jobTitle
                  mail: Topic.mail
                  mailNickname: Topic.mailNickname
                  mobilePhone: Topic.mobilePhone
                  mySite: Topic.mySite
                  officeLocation: Topic.officeLocation
                  pastProjects: Topic.pastProjects
                  postalCode: Topic.postalCode
                  preferredLanguage: Topic.preferredLanguage
                  preferredName: Topic.preferredName
                  responsibilities: Topic.responsibilities
                  schools: Topic.schools
                  skills: Topic.skills
                  state: Topic.state
                  streetAddress: Topic.streetAddress
                  surname: Topic.surname
                  userPrincipalName: Topic.userPrincipalName
                  userType: Topic.userType

            - kind: SendActivity
              id: sendActivity_ULgds4
              activity:
                attachments:
                  - kind: AdaptiveCardTemplate
                    cardContent: |-
                      ={
                        type: "AdaptiveCard",
                        body: [
                          {
                            type: "TextBlock",
                            text: "Your manager is",
                            wrap: true
                          },
                          {
                            type: "ColumnSet",
                            columns: [
                              {
                                type: "Column",
                                items: [
                                  {
                                    type: "TextBlock",
                                    weight: "Bolder",
                                    text: Topic.displayName,
                                    wrap: true
                                  },
                                  {
                                    type: "TextBlock",
                                    spacing: "None",
                                    text: Topic.jobTitle,
                                    isSubtle: true,
                                    wrap: true
                                  }
                                ],
                                width: "stretch"
                              }
                            ]
                          }
                        ],
                        '$schema': "http://adaptivecards.io/schemas/adaptive-card.json",
                        version: "1.3"
                      }

        - id: conditionItem_zsm8vP
          condition: =Topic.userChoice = '{ REPLACE-WITH-INTERNAL-COPILOT-NAME }.topic.GetManagerDetails.main.question_4MfIos'.'My colleague''s manager'
          actions:
            - kind: Question
              id: question_EjT7mU
              interruptionPolicy:
                allowInterruption: true

              variable: init:Topic.colleagueName
              prompt: What is your colleague's name?
              entity: StringPrebuiltEntity

            - kind: Question
              id: question_AHWowM
              interruptionPolicy:
                allowInterruption: true

              variable: Topic.userEmail
              prompt: What's {Topic.colleagueName}'s email address?
              entity: StringPrebuiltEntity

            - kind: BeginDialog
              id: vvYdU0
              input:
                binding:
                  id: =Topic.userEmail

              dialog: { REPLACE-WITH-INTERNAL-COPILOT-NAME }.component.Office365Users-GetmanagerV2
              output:
                binding:
                  aboutMe: Topic.aboutMe
                  accountEnabled: Topic.accountEnabled
                  birthday: Topic.birthday
                  businessPhones: Topic.businessPhones
                  city: Topic.city
                  companyName: Topic.companyName
                  country: Topic.country
                  department: Topic.department
                  displayName: Topic.displayName
                  givenName: Topic.givenName
                  hireDate: Topic.hireDate
                  id: Topic.id
                  interests: Topic.interests
                  jobTitle: Topic.jobTitle
                  mail: Topic.mail
                  mailNickname: Topic.mailNickname
                  mobilePhone: Topic.mobilePhone
                  mySite: Topic.mySite
                  officeLocation: Topic.officeLocation
                  pastProjects: Topic.pastProjects
                  postalCode: Topic.postalCode
                  preferredLanguage: Topic.preferredLanguage
                  preferredName: Topic.preferredName
                  responsibilities: Topic.responsibilities
                  schools: Topic.schools
                  skills: Topic.skills
                  state: Topic.state
                  streetAddress: Topic.streetAddress
                  surname: Topic.surname
                  userPrincipalName: Topic.userPrincipalName
                  userType: Topic.userType

            - kind: SendActivity
              id: sendActivity_bLVv2l
              activity:
                attachments:
                  - kind: AdaptiveCardTemplate
                    cardContent: |-
                      ={
                        type: "AdaptiveCard",
                        body: [
                          {
                            type: "TextBlock",
                            text: Topic.colleagueName & "'s manager is",
                            wrap: true
                          },
                          {
                            type: "ColumnSet",
                            columns: [
                              {
                                type: "Column",
                                items: [
                                  {
                                    type: "TextBlock",
                                    weight: "Bolder",
                                    text: Topic.displayName,
                                    wrap: true
                                  },
                                  {
                                    type: "TextBlock",
                                    spacing: "None",
                                    text: Topic.jobTitle,
                                    isSubtle: true,
                                    wrap: true
                                  }
                                ],
                                width: "stretch"
                              }
                            ]
                          }
                        ],
                        '$schema': "http://adaptivecards.io/schemas/adaptive-card.json",
                        version: "1.3"
                      }

      elseActions:
        - kind: EndConversation
          id: rw5Xcc